<html>

<head>
  <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>通过bmdb项目为Gridea主题添加豆瓣电影页面 | Vapour</title>
<link rel="shortcut icon" href="https://kevinmatr.github.io/favicon.ico">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
  integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://kevinmatr.github.io/styles/main.css">
<link rel="apple-touch-icon" href="https://kevinmatr.github.io/favicon.ico">
<meta name="apple-mobile-web-app-title" content="XiaoX 博客">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />


<!-- iconfont -->
<link href="https://at.alicdn.com/t/font_2463772_e2doyz0d1wv.css" rel="stylesheet" />

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>

<!-- DEMO JS -->
<script src="media/scripts/index.js"></script>


</head>

<body>
  <div class="main">
    <div class="main-content">
      <div class="nav-bar">
  <!-- 首页菜单 -->
  <div class="menu-container">
    <a href="https://kevinmatr.github.io/index.html" target="_parent" class="home">
	<link rel="preconnect" href="https://fonts.gstatic.com">
	<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap" rel="stylesheet">
      <svg class="home-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="24" height="24">
        <path fill="#fff" d="M12 14l9-5-9-5-9 5 9 5z"></path>
        <path fill="#fff"
          d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z">
        </path>
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
          d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222">
        </path>
      </svg>
      <span class="home-title">Home</span>
    </a>

    <div class="nav-menu">
      
      
      <a href="/archives" class="menu">
        Archives
      </a>
      
      
      
      <a href="/tags" class="menu">
        Tags
      </a>
      
      
      
      <a href="/post/about" class="menu">
        About
      </a>
      
      
      
      <a href="https://kevinmatr.github.io/movies" class="menu">
        Movies
      </a>
      
      



      <a href="https://kevinmatr.github.io/atom.xml" target="_blank" class="rss">
        <span class="rss-title">RSS</span>
        <i class="iconfont icon-rss"></i>
      </a>
    </div>
  </div>
</div>

      <div class="post-detail">
        <article class="post">
          
          <div class="post-tag">
            <svg class="tag-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M7 7h.01M7 3h5a1.99 1.99 0 011.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z">
              </path>
            </svg>
            <a href="https://kevinmatr.github.io/tag/QnRWsTZGr/" class="tag">
              Gridea
            </a>
          </div>
          
          <h2 class="post-title">
            通过bmdb项目为Gridea主题添加豆瓣电影页面
          </h2>

          <div class="post-info">
            <svg class="post-date" fill="none" viewBox="0 0 24 24" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
            </svg>
            <time class="post-time">
              2021-01-31
            </time>
            <svg fill="none" class="view-icon" viewBox="0 0 24 24" stroke="currentColor" width="16" height="16">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
              </path>
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z">
              </path>
            </svg>
            <span id="/add-douban-movie-page-for-gridea/" class="leancloud_visitors" data-flag-title="通过bmdb项目为Gridea主题添加豆瓣电影页面">
              <span class="leancloud-visitors-count"></span><span> 次阅读</span>
            </span>
            <span>
              5 min read
            </span>
          </div>

          
          <div class="post-content">
            <p>🎥🎥🎥</p>
<!-- more -->
<br/>
之前在翻找Gridea主题看到无意中看到[biocron-pro](https://github.com/qyxtim/bitcron-pro)作者的博客里有一个[电影页面](https://blog.blinkstar.cn/movies)。仔细看发现可以发现数据来自豆瓣，推测记录来自豆瓣观影记录，感觉在博客中加一个电影页确实是个不错的点子🤠
<br/>
搜索发现了[bmdb](https://github.com/iMuFeng/bmdb)这个项目，提供了的接口可以很方便的帮忙拉到数据，但是搜索发现具体怎么添加到主题内并没有一个教程，~~果然Gridea还是太小众了~~。最后摸索着实现了，经过实测这个方法可以给大部分的主题添加电影页面，但是由于主题布局的不同可能会出现错位的问题，需要在相应主题的main.less中作出相应的修改。
<br/>
<br/>
<h2 id="1-将代码添加到文件中">1. 将代码添加到文件中</h2>
<p>我们要先在菜单为电影页面添加一个入口</p>
<p>打开Gridea的客户端，进入菜单页面，创建一个菜单，名<br>
称随意，选择内链，Link处填入<code>你的博客网址/movies</code><br>
<img src="https://kevinmatr.github.io/post-images/1612084370887.png" alt="添加页面" loading="lazy"></p>
<br/>
<h2 id="2-注册bmdb项目并获取接口">2. 注册bmdb项目并获取接口</h2>
<p>打开<a href="https://bm.weajs.com/">注册网址</a>，注册账号后来到设置</p>
<p>添入你的豆瓣ID后保存设置，并将电影列表处<code>secret=</code>后的代码复制备用</p>
<p>来到电影页面点击同步数据，查看是否能够拉取观影数据<br>
<img src="https://kevinmatr.github.io/post-images/1612084430176.png" alt="获取接口" loading="lazy"></p>
<br/>
<h2 id="3创建moviesejs并加入bmdb代码">3.创建movies.ejs并加入bmdb代码</h2>
<p>打开Gridea的主题文件夹，找到想要加入的主题，进入<code>主题名\templates</code>路径，创建一个<code>movies.ejs</code>文件</p>
<p>接下来我们需要观察文件的结构，不同的主题文件结构会有些许不同，但是万变不离其宗。我们要做的是创建一个div块作为container使得电影能够在页面中显示。然后我们要将这个div块塞在header以及footer中间，就像这样</p>
<pre><code class="language-css">&lt;div class=&quot;main animated&quot;&gt;
    &lt;%- include('./includes/header') %&gt;
&lt;/div&gt;
&lt;div class=&quot;dbcontainer&quot;&gt;&lt;/div&gt; /* 这是container所在的块 */
&lt;%- include('./includes/footer') %&gt; 
</code></pre>
<p>下面用一个主题作为实例</p>
<p>我们打开<code>archives.ejs</code>文件来观察这个主题的样式结构</p>
<pre><code class="language-css">&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;%- include('./includes/head', { siteTitle: themeConfig.siteName }) %&gt;
&lt;/head&gt;


&lt;body&gt;

&lt;div class=&quot;main animated&quot;&gt;
    &lt;%- include('./includes/header') %&gt;
    &lt;%- include('./includes/post-list-archives') %&gt;
&lt;/div&gt;

&lt;%- include('./includes/footer') %&gt;
&lt;/body&gt;

&lt;/html&gt;
</code></pre>
<p>可以看到header下面紧接着就是归档列表了，那我们就可以照葫芦绘瓢讲container加到header下面就好。<strong>注意：并不是每一个主题的结构都如此简单，但是大框架不会变，只需要在header以及重要的元素下面加入container即可</strong></p>
<p>我们将<code>archives.ejs</code>中的代码整个复制到<code>movies.ejs</code>中，然后将代码替换成container的div块。</p>
<p>接下来我们加入bmdb项目的代码</p>
<h3 id="设置html头部并引入资源">设置html头部并引入资源</h3>
<p>在html头部中加入如下代码</p>
<pre><code class="language-css">&lt;head&gt;
  &lt;meta name=&quot;referrer&quot; content=&quot;same-origin&quot;&gt;
  &lt;script src=&quot;https://cdn.jsdelivr.net/gh/iMuFeng/bmdb@3.1.0/dist/bmdb.js&quot; /&gt;
&lt;/head&gt;
</code></pre>
<h3 id="初始化参数">初始化参数</h3>
<p>在script中加入如下代码</p>
<pre><code class="language-css">&lt;script&gt;
new Bmdb({
  type: 'movie',
  selector: '.xxx', /*与body中的div块同名*/
  secret: '7bf4205a0a62d00409f3cd70b0736e1a11a9a6a60f7231567f056819787b8096', /*第二步中复制的secret*/
  noMoreDataTips: '没有更多数据了'
})
&lt;/script&gt;
</code></pre>
<p><strong>做完这一步基本上就完成了，预览一下电影页面看看能不能正常显示，如果可以就可以去豆瓣完善观影记录了，如果发现错位等问题就进入微调环节</strong></p>
<figure data-type="image" tabindex="1"><img src="https://kevinmatr.github.io/post-images/1612084553309.png" alt="效果预览" loading="lazy"></figure>
<br/>
<h2 id="4通过mainless微调电影页布局">4.通过main.less微调电影页布局</h2>
<p>因为主题的布局可能会遇到各种奇怪的问题，比如电影页面错位，或者电影只显示前几十个就刷不下去了。这时候我们就要在<code>main.less</code>里对整体布局进行调整了。</p>
<p>打开<code>主题名\assets\styles\main.less</code> ，搜索<code>.main</code>，它是页面的主要布局文件。然后我们创建一个<code>.你的container名称</code>，将<code>.main</code>的代码照搬过来</p>
<pre><code class="language-css">.main { 
  background: #FFFFFF;
  box-shadow: 0px 10px 20px 0px rgba(236, 236, 236, 0.86);
  width: 820px;
  margin: 0 auto;
  margin-top: 60px;
}
.dbcontainer {
  background: #FFFFFF;
  box-shadow: 0px 10px 20px 0px rgba(236, 236, 236, 0.86);
  width: 720px;
  margin: 0 auto;
  margin-top: 0px;
  padding: 50px 50px 50px 50px;
</code></pre>
<p>这样基本没有问题了，如果还是错位通过调整margin和padding也能够很好解决</p>
<p>如果你遇到电影只显示前几十个就刷不下去了，看看<code>main.less</code>的开头是不是有类似这样的代码</p>
<pre><code class="language-css">html,body{
  height:100%;
  overflow-x:hidden;
}
</code></pre>
<p>将overflow-x整句删除或者修改后面属性即可</p>
<br/>
<h3 id="最后">最后</h3>
<blockquote>
<p>感谢<a href="https://bm.weajs.com/">布克牧为</a>提供的豆瓣电影api</p>
</blockquote>

          </div>
        </article>
      </div>

      <div class="near-post">
        <div>
          
        </div>
        <div>
          
        </div>
      </div>

      

      <div class="valine">
        
      </div>

      <div class="site-footer">
  Ⓒ 2021 Leon
  
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>
    </div>
  </div>
</body>

</html>